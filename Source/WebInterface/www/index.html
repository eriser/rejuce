<!DOCTYPE html>

<meta charset="utf-8" />

<title>WebSocket Test</title>

<script language="javascript" type="text/javascript">

var wsUri = "ws://localhost:8080/";
var output;
var websocket;

function init()
{
	output = document.getElementById("output");
	connectWebSocket();
}

function connectWebSocket()
{
	websocket = new WebSocket(wsUri);
	websocket.onopen = function(evt) { onOpen(evt) };
	websocket.onclose = function(evt) { onClose(evt) };
	websocket.onmessage = function(evt) { onMessage(evt) };
	websocket.onerror = function(evt) { onError(evt) };
}

function onOpen(evt)
{
 	trace("CONNECTED");
}

function onClose(evt)
{
	trace("DISCONNECTED, reconnect: "+evt.data);
	websocket = new WebSocket(wsUri);
}

function onError(evt)
{
	trace('ERROR, attempt reconnect: '+evt.data);
	websocket = new WebSocket(wsUri);
}

function onMessage(evt)
{
	trace('RESPONSE: ' + evt.data);
}

function doSend()
{
	// make json
	var json = '{"event": "'+arguments[0]+'",';
	json += '"args":[';
	for (i=1;i<arguments.length;i++)
	{
		json+=''+arguments[i];
		if (i!=arguments.length-1)
		{
			json +=',';
		}
	}
	json += ']}';

	trace("SENT: " + json); 
	websocket.send(json);
}

function trace(message)
{
	console.log(message);
}


window.addEventListener("load", init, false);

</script>

<input type="button" name="record" value="(r)" onclick="doSend('record')"></input>
<input type="button" name="stop" value="[ ]" onclick="doSend('stop')"></input>
<input type="button" name="play" value="|>" onclick="doSend('play')"></input>
<input type="button" name="pause" value="||" onclick="doSend('pause')"></input>

</html> 