<!DOCTYPE html>

<meta charset="utf-8" />

<head>
<title>WebSocket Test</title>

<STYLE>
td.center
{
	text-align:center;
}
.center
{
	margin-left:auto;
	margin-right:auto;
}

.ledGreenOff
{
	background: url('green_light_off.png') no-repeat;
	width:12;
	height:12;
	display: block;
}
.ledGreenOn
{
	background: url('green_light_on.png') no-repeat;
	width:12;
	height:12;
}
.ledRedOff
{
	background: url('red_light_off.png') no-repeat;
	width:12;
	height:12;
}
.ledRedOn
{
	background: url('red_light_on.png') no-repeat;
	width:12;
	height:12;
}

.buttonWhite
{
	background: url('button_white.png') no-repeat;
	width:54px;
	height:56px
}
.buttonBlack
{
	background: url('button_black.png') no-repeat;
	width:54px;
	height:57px
}

.buttonTransportRecord
{
	background: url('transport_record.png') no-repeat;
	width:52px;
	height:31px;
}
.buttonTransporStop
{
	background: url('transport_stop.png') no-repeat;
	width:52px;
	height:31px;
}
.buttonTransportBack
{
	background: url('transport_back.png') no-repeat;
	width:52px;
	height:31px;
}
.buttonTransportPause
{
	background: url('transport_pause.png') no-repeat;
	width:52px;
	height:31px;
}
.buttonTransportPlay
{
	background: url('transport_play.png') no-repeat;
	width:52px;
	height:31px;
}
</STYLE>

<script language="javascript" type="text/javascript" src="jquery-1.9.1.js"></script>
<script language="javascript" type="text/javascript">

var wsUri = "ws://localhost:8080/";
var output;
var websocket;

function init()
{
	output = document.getElementById("output");
	connectWebSocket();
}

function connectWebSocket()
{
	websocket = new WebSocket(wsUri);
	websocket.onopen = function(evt) { onOpen(evt) };
	websocket.onclose = function(evt) { onClose(evt) };
	websocket.onmessage = function(evt) { onMessage(evt) };
	websocket.onerror = function(evt) { onError(evt) };
}

function onOpen(evt)
{
 	trace("CONNECTED");
}

function onClose(evt)
{
	trace("DISCONNECTED, reconnect: "+evt.data);
	//websocket = new WebSocket(wsUri);
}

function onError(evt)
{
	trace('ERROR, attempt reconnect: '+evt.data);
	//websocket = new WebSocket(wsUri);
}

function onMessage(evt)
{
	trace('RECVD: ' + evt.data);
	json = $.parseJSON(evt.data);
	
	switch (json.event)
	{
		case "led":
			setLed(json.control,json.argv);
		break;
		default: break;		
	}
	
	
}

function doSend(event,control,argv)
{
	// make json
	var json = '{"event": "'+event+'",';
	json += '"control": "'+control+'",';
	json += '"argv": '+argv;
	json += '}';

	trace("SENT: " + json); 
	websocket.send(json);
}

function trace(message)
{
	console.log(message);
}


window.addEventListener("load", init, false);

function setLed(control,argv)
{
	var led = $('#' + control);
	var cname = led[0].className;
	
	switch (Number(argv))
	{
	case 0:
		cname = cname.replace("On","Off");
	break;
	case 1:
		cname = cname.replace("Off","On");
	break;
	}
	
	led.attr("class", cname);
}


</script>	

</head>
<body>

<a href='javascript:setLed("playing",1);'>test</a>

<!-- transport -->

<table>
<tr>
<td class="center">
<div class="ledRedOff" id="recording">&nbsp;</div>
</td><td>
&nbsp;
</td><td>
&nbsp;
</td><td>
&nbsp;
</td><td class="center">
<div class="ledGreenOff" id="playing">&nbsp;</div>
</td>
</tr>
<tr>
<td>
<input type="button" class="buttonTransportRecord" name="record" onclick="doSend('buttonDown','record',0)"></input>
</td><td>
<input type="button" class="buttonTransporStop" name="stop" onclick="doSend('buttonDown','stop',0)"></input>
</td><td>
<input type="button" class="buttonTransportBack" name="back" onclick="doSend('buttonDown','back',0)"></input>
</td><td>
<input type="button" class="buttonTransportPause" name="pause" onclick="doSend('buttonDown','pause',0)"></input>
</td><td>
<input type="button" class="buttonTransportPlay" name="play" onclick="doSend('buttonDown','play',0)"></input>
</td>
</tr>
</table>

<br/>
<br/>
<br/>
<br/>

<!-- piano bit -->
<TABLE>
		<TR>
		<table><tr>
			<TD width="90">&nbsp;</TD>
			<TD><INPUT class="buttonBlack" TYPE="BUTTON" NAME="Button_ALL" ONCLICK="buttonPress('ALL')"></TD>
			<TD><INPUT class="buttonBlack" TYPE="BUTTON" NAME="Button_1OT8" ONCLICK="buttonPress('1to8')"></TD>
			<TD><INPUT class="buttonBlack" TYPE="BUTTON" NAME="Button_9TO16" ONCLICK="buttonPress('9to16')"></TD>
			<TD width="50">&nbsp;</TD>
			<TD><INPUT class="buttonBlack" TYPE="BUTTON" NAME="Button_BLANK" ONCLICK="buttonPress('BLANK')"></TD>
			<TD><INPUT class="buttonBlack" TYPE="BUTTON" NAME="Button_BPM" ONCLICK="buttonPress('BPM')"></TD>
			<TD width="50">&nbsp;</TD>
			<TD><INPUT class="buttonBlack" TYPE="BUTTON" NAME="Button_MUTEMEM1" ONCLICK="buttonPress('MUTEMEM1')"></TD>
			<TD><INPUT class="buttonBlack" TYPE="BUTTON" NAME="Button_MUTEMEM2" ONCLICK="buttonPress('MUTEMEM2')"></TD>
			<TD><INPUT class="buttonBlack" TYPE="BUTTON" NAME="Button_MUTEMEM3" ONCLICK="buttonPress('MUTEMEM3')"></TD>
			<TD width="50">&nbsp;</TD>
			<TD><INPUT class="buttonBlack" TYPE="BUTTON" NAME="Button_MUTEMEM4" ONCLICK="buttonPress('MUTEMEM4')"></TD>
			<TD><INPUT class="buttonBlack" TYPE="BUTTON" NAME="Button_MUTEMEM5" ONCLICK="buttonPress('MUTEMEM5')"></TD>
			<TD width="50">&nbsp;</TD>
			<TD><INPUT class="buttonWhite" TYPE="BUTTON" NAME="Button_ENTERTAP" ONCLICK="buttonPress('ENTERTAP')"></TD>
			</tr></table>
		</TR>
		<TR>
		<table><tr>
			<TD CLASS="center"><IMG class="led" SRC="red_light_on.png"></TD>
			<TD CLASS="center"><IMG class="led" SRC="red_light_off.png"></TD>
			<TD CLASS="center"><IMG class="led" SRC="red_light_on.png"></TD>
			<TD CLASS="center"><IMG class="led" SRC="red_light_off.png"></TD>
			<TD CLASS="center"><IMG class="led" SRC="red_light_off.png"></TD>
			<TD CLASS="center"><IMG class="led" SRC="red_light_off.png"></TD>
			<TD CLASS="center"><IMG class="led" SRC="red_light_on.png"></TD>
			<TD CLASS="center"><IMG class="led" SRC="red_light_off.png"></TD>
			<TD CLASS="center"><IMG class="led" SRC="red_light_on.png"></TD>
			<TD CLASS="center"><IMG class="led" SRC="red_light_off.png"></TD>
			<TD CLASS="center"><IMG class="led" SRC="red_light_off.png"></TD>
			<TD CLASS="center"><IMG class="led" SRC="red_light_on.png"></TD>
			<TD CLASS="center"><IMG class="led" SRC="red_light_off.png"></TD>
			<TD CLASS="center"><IMG class="led" SRC="red_light_off.png"></TD>
			<TD CLASS="center"><IMG class="led" SRC="red_light_off.png"></TD>
			<TD CLASS="center"><IMG class="led" SRC="red_light_on.png"></TD>
			</tr>
			<tr>
			<TD><INPUT class="buttonWhite" TYPE="BUTTON" NAME="Button_A" ONCLICK="buttonPress('A')"></TD>
			<TD><INPUT class="buttonWhite" TYPE="BUTTON" NAME="Button_B" ONCLICK="buttonPress('B')"></TD>
			<TD><INPUT class="buttonWhite" TYPE="BUTTON" NAME="Button_C" ONCLICK="buttonPress('C')"></TD>
			<TD><INPUT class="buttonWhite" TYPE="BUTTON" NAME="Button_D" ONCLICK="buttonPress('D')"></TD>
			<TD><INPUT class="buttonWhite" TYPE="BUTTON" NAME="Button_E" ONCLICK="buttonPress('E')"></TD>
			<TD><INPUT class="buttonWhite" TYPE="BUTTON" NAME="Button_F" ONCLICK="buttonPress('F')"></TD>
			<TD><INPUT class="buttonWhite" TYPE="BUTTON" NAME="Button_G" ONCLICK="buttonPress('G')"></TD>
			<TD><INPUT class="buttonWhite" TYPE="BUTTON" NAME="Button_H" ONCLICK="buttonPress('H')"></TD>
			<TD><INPUT class="buttonWhite" TYPE="BUTTON" NAME="Button_I" ONCLICK="buttonPress('I')"></TD>
			<TD><INPUT class="buttonWhite" TYPE="BUTTON" NAME="Button_J" ONCLICK="buttonPress('J')"></TD>
			<TD><INPUT class="buttonWhite" TYPE="BUTTON" NAME="Button_K" ONCLICK="buttonPress('K')"></TD>
			<TD><INPUT class="buttonWhite" TYPE="BUTTON" NAME="Button_L" ONCLICK="buttonPress('L')"></TD>
			<TD><INPUT class="buttonWhite" TYPE="BUTTON" NAME="Button_M" ONCLICK="buttonPress('M')"></TD>
			<TD><INPUT class="buttonWhite" TYPE="BUTTON" NAME="Button_N" ONCLICK="buttonPress('N')"></TD>
			<TD><INPUT class="buttonWhite" TYPE="BUTTON" NAME="Button_O" ONCLICK="buttonPress('O')"></TD>
			<TD><INPUT class="buttonWhite" TYPE="BUTTON" NAME="Button_P" ONCLICK="buttonPress('P')"></TD>
			</tr></table>
		</TR>
		</TABLE> 

</body>
</html> 